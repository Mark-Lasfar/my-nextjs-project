{"version":3,"names":["default","cov_q3gxjqe3e","f","s","_default","metadata","title","CheckoutPaymentPage","props","params","id","order","_orderactions","getOrderById","b","_navigation","notFound","session","_auth","auth","client_secret","paymentMethod","isPaid","stripe","_stripe","process","env","STRIPE_SECRET_KEY","paymentIntent","paymentIntents","create","amount","Math","round","totalPrice","currency","orderId","_id","_jsxruntime","jsx","_paymentform","paypalClientId","PAYPAL_CLIENT_ID","clientSecret","isAdmin","user","role"],"sources":["/home/mark/Downloads/nextjs-amazona-main/app/[locale]/checkout/[id]/page.tsx"],"sourcesContent":["import { notFound } from 'next/navigation'\nimport React from 'react'\n\nimport { auth } from '@/auth'\nimport { getOrderById } from '@/lib/actions/order.actions'\nimport PaymentForm from './payment-form'\nimport Stripe from 'stripe'\n\nexport const metadata = {\n  title: 'Payment',\n}\n\nconst CheckoutPaymentPage = async (props: {\n  params: Promise<{\n    id: string\n  }>\n}) => {\n  const params = await props.params\n\n  const { id } = params\n\n  const order = await getOrderById(id)\n  if (!order) notFound()\n\n  const session = await auth()\n\n  let client_secret = null\n  if (order.paymentMethod === 'Stripe' && !order.isPaid) {\n    const stripe = new Stripe(process.env.STRIPE_SECRET_KEY as string)\n    const paymentIntent = await stripe.paymentIntents.create({\n      amount: Math.round(order.totalPrice * 100),\n      currency: 'USD',\n      metadata: { orderId: order._id },\n    })\n    client_secret = paymentIntent.client_secret\n  }\n  return (\n    <PaymentForm\n      order={order}\n      paypalClientId={process.env.PAYPAL_CLIENT_ID || 'sb'}\n      clientSecret={client_secret}\n      isAdmin={session?.user?.role === 'Admin' || false}\n    />\n  )\n}\n\nexport default CheckoutPaymentPage\n"],"mappings":"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","ignoreList":[]}