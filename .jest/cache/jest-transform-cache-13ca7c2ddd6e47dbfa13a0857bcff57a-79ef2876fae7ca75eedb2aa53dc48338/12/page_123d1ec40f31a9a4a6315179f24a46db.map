{"version":3,"names":["default","cov_1fx8v6w6au","f","s","ProductDetails","generateMetadata","props","t","_server","getTranslations","params","product","_productactions","getProductBySlug","slug","b","title","name","description","searchParams","page","color","size","session","_auth","auth","relatedProducts","getRelatedProductsByCategory","category","productId","_id","Number","_jsxruntime","jsxs","jsx","_addtobrowsinghistory","id","className","_productgallery","images","brand","_ratingsummary","avgRating","numReviews","asPopover","ratingDistribution","_separator","Separator","_productprice","price","listPrice","isDeal","tags","includes","forListing","_selectvariant","sizes","colors","_card","Card","CardContent","countInStock","count","_addtocart","item","clientId","_utils","generateId","round2","quantity","image","_reviewlist","userId","user","_productslider","products","data","_browsinghistorylist"],"sources":["/home/mark/Downloads/nextjs-amazona-main/app/[locale]/(root)/product/[slug]/page.tsx"],"sourcesContent":["import { auth } from '@/auth'\nimport AddToCart from '@/components/shared/product/add-to-cart'\nimport { Card, CardContent } from '@/components/ui/card'\nimport {\n  getProductBySlug,\n  getRelatedProductsByCategory,\n} from '@/lib/actions/product.actions'\n\nimport ReviewList from './review-list'\nimport { generateId, round2 } from '@/lib/utils'\nimport SelectVariant from '@/components/shared/product/select-variant'\nimport ProductPrice from '@/components/shared/product/product-price'\nimport ProductGallery from '@/components/shared/product/product-gallery'\nimport AddToBrowsingHistory from '@/components/shared/product/add-to-browsing-history'\nimport { Separator } from '@/components/ui/separator'\nimport BrowsingHistoryList from '@/components/shared/browsing-history-list'\nimport RatingSummary from '@/components/shared/product/rating-summary'\nimport ProductSlider from '@/components/shared/product/product-slider'\nimport { getTranslations } from 'next-intl/server'\n\nexport async function generateMetadata(props: {\n  params: Promise<{ slug: string }>\n}) {\n  const t = await getTranslations()\n  const params = await props.params\n  const product = await getProductBySlug(params.slug)\n  if (!product) {\n    return { title: t('Product.Product not found') }\n  }\n  return {\n    title: product.name,\n    description: product.description,\n  }\n}\n\nexport default async function ProductDetails(props: {\n  params: Promise<{ slug: string }>\n  searchParams: Promise<{ page: string; color: string; size: string }>\n}) {\n  const searchParams = await props.searchParams\n\n  const { page, color, size } = searchParams\n\n  const params = await props.params\n\n  const { slug } = params\n\n  const session = await auth()\n\n  const product = await getProductBySlug(slug)\n\n  const relatedProducts = await getRelatedProductsByCategory({\n    category: product.category,\n    productId: product._id,\n    page: Number(page || '1'),\n  })\n\n  const t = await getTranslations()\n  return (\n    <div>\n      <AddToBrowsingHistory id={product._id} category={product.category} />\n      <section>\n        <div className=\"grid grid-cols-1 md:grid-cols-5  \">\n          <div className=\"col-span-2\">\n            <ProductGallery images={product.images} />\n          </div>\n\n          <div className=\"flex w-full flex-col gap-2 md:p-5 col-span-2\">\n            <div className=\"flex flex-col gap-3\">\n              <p className=\"p-medium-16 rounded-full bg-grey-500/10   text-grey-500\">\n                {t('Product.Brand')} {product.brand} {product.category}\n              </p>\n              <h1 className=\"font-bold text-lg lg:text-xl\">{product.name}</h1>\n\n              <RatingSummary\n                avgRating={product.avgRating}\n                numReviews={product.numReviews}\n                asPopover\n                ratingDistribution={product.ratingDistribution}\n              />\n              <Separator />\n              <div className=\"flex flex-col gap-3 sm:flex-row sm:items-center\">\n                <div className=\"flex gap-3\">\n                  <ProductPrice\n                    price={product.price}\n                    listPrice={product.listPrice}\n                    isDeal={product.tags.includes('todays-deal')}\n                    forListing={false}\n                  />\n                </div>\n              </div>\n            </div>\n            <div>\n              <SelectVariant\n                product={product}\n                size={size || product.sizes[0]}\n                color={color || product.colors[0]}\n              />\n            </div>\n            <Separator className=\"my-2\" />\n            <div className=\"flex flex-col gap-2\">\n              <p className=\"p-bold-20 text-grey-600\">\n                {t('Product.Description')}:\n              </p>\n              <p className=\"p-medium-16 lg:p-regular-18\">\n                {product.description}\n              </p>\n            </div>\n          </div>\n          <div>\n            <Card>\n              <CardContent className=\"p-4 flex flex-col  gap-4\">\n                <ProductPrice price={product.price} />\n\n                {product.countInStock > 0 && product.countInStock <= 3 && (\n                  <div className=\"text-destructive font-bold\">\n                    {t('Product.Only X left in stock - order soon', {\n                      count: product.countInStock,\n                    })}\n                  </div>\n                )}\n                {product.countInStock !== 0 ? (\n                  <div className=\"text-green-700 text-xl\">\n                    {t('Product.In Stock')}\n                  </div>\n                ) : (\n                  <div className=\"text-destructive text-xl\">\n                    {t('Product.Out of Stock')}\n                  </div>\n                )}\n\n                {product.countInStock !== 0 && (\n                  <div className=\"flex justify-center items-center\">\n                    <AddToCart\n                      item={{\n                        clientId: generateId(),\n                        product: product._id,\n                        countInStock: product.countInStock,\n                        name: product.name,\n                        slug: product.slug,\n                        category: product.category,\n                        price: round2(product.price),\n                        quantity: 1,\n                        image: product.images[0],\n                        size: size || product.sizes[0],\n                        color: color || product.colors[0],\n                      }}\n                    />\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </section>\n      <section className=\"mt-10\">\n        <h2 className=\"h2-bold mb-2\" id=\"reviews\">\n          {t('Product.Customer Reviews')}\n        </h2>\n        <ReviewList product={product} userId={session?.user.id} />\n      </section>\n      <section className=\"mt-10\">\n        <ProductSlider\n          products={relatedProducts.data}\n          title={t('Product.Best Sellers in', { name: product.category })}\n        />\n      </section>\n      <section>\n        <BrowsingHistoryList className=\"mt-10\" />\n      </section>\n    </div>\n  )\n}\n"],"mappings":"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","ignoreList":[]}