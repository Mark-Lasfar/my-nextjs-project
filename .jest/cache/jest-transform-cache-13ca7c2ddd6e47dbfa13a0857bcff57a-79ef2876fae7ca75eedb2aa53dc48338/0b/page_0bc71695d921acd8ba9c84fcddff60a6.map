{"version":3,"names":["SuccessPage","stripe","cov_2d136kykrm","s","_stripe","default","process","env","STRIPE_SECRET_KEY","props","f","params","id","searchParams","order","_orderactions","getOrderById","b","_navigation","notFound","paymentIntent","paymentIntents","retrieve","payment_intent","metadata","orderId","_id","toString","isSuccess","status","redirect","_jsxruntime","jsx","className","jsxs","_button","Button","asChild","_link","href"],"sources":["/home/mark/Downloads/nextjs-amazona-main/app/[locale]/checkout/[id]/stripe-payment-success/page.tsx"],"sourcesContent":["import Link from 'next/link'\nimport { notFound, redirect } from 'next/navigation'\nimport Stripe from 'stripe'\n\nimport { Button } from '@/components/ui/button'\nimport { getOrderById } from '@/lib/actions/order.actions'\n\nconst stripe = new Stripe(process.env.STRIPE_SECRET_KEY as string)\n\nexport default async function SuccessPage(props: {\n  params: Promise<{\n    id: string\n  }>\n  searchParams: Promise<{ payment_intent: string }>\n}) {\n  const params = await props.params\n\n  const { id } = params\n\n  const searchParams = await props.searchParams\n  const order = await getOrderById(id)\n  if (!order) notFound()\n\n  const paymentIntent = await stripe.paymentIntents.retrieve(\n    searchParams.payment_intent\n  )\n  if (\n    paymentIntent.metadata.orderId == null ||\n    paymentIntent.metadata.orderId !== order._id.toString()\n  )\n    return notFound()\n\n  const isSuccess = paymentIntent.status === 'succeeded'\n  if (!isSuccess) return redirect(`/checkout/${id}`)\n  return (\n    <div className=\"max-w-4xl w-full mx-auto space-y-8\">\n      <div className=\"flex flex-col gap-6 items-center \">\n        <h1 className=\"font-bold text-2xl lg:text-3xl\">\n          Thanks for your purchase\n        </h1>\n        <div>We are now processing your order.</div>\n        <Button asChild>\n          <Link href={`/account/orders/${id}`}>View order</Link>\n        </Button>\n      </div>\n    </div>\n  )\n}\n"],"mappings":"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","ignoreList":[]}