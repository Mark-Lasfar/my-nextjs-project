{"version":3,"names":["GET","cov_2madnhnj2r","f","site","url","s","_settingactions","getSetting","baseUrl","b","startsWith","replace","now","Date","toISOString","products","_productmodel","default","find","isPublished","select","lean","xml","map","product","slug","updatedAt","join","_server","NextResponse","headers"],"sources":["/home/mark/Downloads/nextjs-amazona-main/app/sitemap-products.xml/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport { getSetting } from '@/lib/actions/setting.actions'\nimport Product from '@/lib/db/models/product.model' \n\nexport async function GET() {\n  const { site: { url } } = await getSetting()\n  const baseUrl = (url && url.startsWith('https://hager-zon.vercel.app'))\n    ? url.replace(/\\/+$/, '')\n    : 'https://hager-zon.vercel.app'\n  const now = new Date().toISOString()\n\n  const products = await Product.find({ isPublished: true })\n    .select('slug updatedAt')\n    .lean()\n\n  const xml = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n  ${products\n    .map(\n      (product) => `\n    <url>\n      <loc>${baseUrl}/product/${product.slug}</loc>\n      <lastmod>${product.updatedAt ? new Date(product.updatedAt).toISOString() : now}</lastmod>\n      <changefreq>daily</changefreq>\n      <priority>0.8</priority>\n    </url>`\n    )\n    .join('')}\n</urlset>`\n\n  return new NextResponse(xml, {\n    headers: {\n      'Content-Type': 'application/xml',\n      'Cache-Control': 'public, max-age=3600, stale-while-revalidate=59',\n    },\n  })\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAIsB;;;;;;WAAAA,GAAA;;;;;kCAJO;;;kCACF;;;wEACP;;;;;;;;;;;;;;;AAEb,eAAeA,IAAA;EAAA;EAAAC,cAAA,GAAAC,CAAA;EACpB,MAAM;IAAEC,IAAA,EAAM;MAAEC;IAAG;EAAE,CAAE;EAAA;EAAA,CAAAH,cAAA,GAAAI,CAAA,OAAG,MAAM,IAAAC,eAAA,CAAAC,UAAU;EAC1C,MAAMC,OAAA;EAAA;EAAA,CAAAP,cAAA,GAAAI,CAAA;EAAU;EAAA,CAAAJ,cAAA,GAAAQ,CAAA,UAAAL,GAAC;EAAA;EAAA,CAAAH,cAAA,GAAAQ,CAAA,UAAOL,GAAA,CAAIM,UAAU,CAAC;EAAA;EAAA,CAAAT,cAAA,GAAAQ,CAAA,UACnCL,GAAA,CAAIO,OAAO,CAAC,QAAQ;EAAA;EAAA,CAAAV,cAAA,GAAAQ,CAAA,UACpB;EACJ,MAAMG,GAAA;EAAA;EAAA,CAAAX,cAAA,GAAAI,CAAA,OAAM,IAAIQ,IAAA,GAAOC,WAAW;EAElC,MAAMC,QAAA;EAAA;EAAA,CAAAd,cAAA,GAAAI,CAAA,QAAW,MAAMW,aAAA,CAAAC,OAAO,CAACC,IAAI,CAAC;IAAEC,WAAA,EAAa;EAAK,GACrDC,MAAM,CAAC,kBACPC,IAAI;EAEP,MAAMC,GAAA;EAAA;EAAA,CAAArB,cAAA,GAAAI,CAAA,QAAM;;IAEVU,QAAA,CACCQ,GAAG,CACDC,OAAA,IAAY;IAAA;IAAAvB,cAAA,GAAAC,CAAA;IAAAD,cAAA,GAAAI,CAAA;IAAA;;aAENG,OAAA,YAAmBgB,OAAA,CAAQC,IAAI;iBAC3BD,OAAA,CAAQE,SAAS;IAAA;IAAA,CAAAzB,cAAA,GAAAQ,CAAA,UAAG,IAAII,IAAA,CAAKW,OAAA,CAAQE,SAAS,EAAEZ,WAAW;IAAA;IAAA,CAAAb,cAAA,GAAAQ,CAAA,UAAKG,GAAA;;;WAGtE;EAAD,CAAC,EAENe,IAAI,CAAC;UACA;EAAA;EAAA1B,cAAA,GAAAI,CAAA;EAER,OAAO,IAAIuB,OAAA,CAAAC,YAAY,CAACP,GAAA,EAAK;IAC3BQ,OAAA,EAAS;MACP,gBAAgB;MAChB,iBAAiB;IACnB;EACF;AACF","ignoreList":[]}