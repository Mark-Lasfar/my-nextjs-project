{"version":3,"names":["GET","cov_xgsxswaur","f","s","site","url","_settingactions","getSetting","baseUrl","b","nowIso","Date","toISOString","imagesDir","_path","default","join","process","cwd","mediaDir","getImagesFromDir","dir","urlPrefix","_fs","existsSync","readdirSync","filter","test","map","loc","updatedAt","images","xml","img","_server","NextResponse","headers","error","console","status"],"sources":["/home/mark/Downloads/nextjs-amazona-main/app/sitemap-images.xml/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport { getSetting } from '@/lib/actions/setting.actions'\nimport fs from 'fs'\nimport path from 'path'\n\nexport async function GET() {\n  try {\n    const { site: { url } } = await getSetting()\n    const baseUrl = url || 'https://hager-zon.vercel.app'\n    const nowIso = new Date().toISOString()\n\n    const imagesDir = path.join(process.cwd(), 'public', 'images')\n    const mediaDir = path.join(process.cwd(), 'public', 'media')\n\n    function getImagesFromDir(dir: string, urlPrefix: string): { loc: string; updatedAt: string }[] {\n      if (!fs.existsSync(dir)) return []\n      return fs\n        .readdirSync(dir)\n        .filter((f) =>\n          /\\.(jpe?g|png|gif|webp|svg|bmp|ico|tiff?)$/i.test(f)\n        )\n        .map((f) => ({\n          loc: `${baseUrl}/${urlPrefix}/${f}`,\n          updatedAt: nowIso, \n        }))\n    }\n\n    const images = [\n      ...getImagesFromDir(imagesDir, 'images'),\n      ...getImagesFromDir(mediaDir, 'media'),\n    ]\n\n    const xml = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n  ${images\n    .map(\n      (img) => `\n    <url>\n      <loc>${img.loc}</loc>\n      <lastmod>${img.updatedAt}</lastmod>\n      <changefreq>monthly</changefreq>\n      <priority>0.6</priority>\n    </url>`\n    )\n    .join('\\n')}\n</urlset>`\n\n    return new NextResponse(xml, {\n      headers: {\n        'Content-Type': 'application/xml'\n      }\n    })\n  } catch (error) {\n    console.error('Error generating images sitemap:', error)\n    return new NextResponse('Error generating sitemap', { status: 500 })\n  }\n}"],"mappings":"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","ignoreList":[]}