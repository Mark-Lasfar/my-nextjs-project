{"version":3,"names":["default","cov_1a7cew2hu7","f","s","sitemap","revalidate","STATIC_PAGES","path","priority","DEFAULT_BASE_URL","getBaseUrl","url","b","startsWith","replace","createStaticRoutes","baseUrl","routes","locale","_routing","routing","locales","push","lastModified","Date","changeFrequency","_db","connectToDatabase","site","_settingactions","getSetting","products","_productmodel","find","isPublished","deletedAt","$exists","select","lean","productUrls","product","slug","updatedAt","staticRoutes","error","console","map","route","Math","max"],"sources":["/home/mark/Downloads/nextjs-amazona-main/app/sitemap.ts"],"sourcesContent":["import { MetadataRoute } from 'next'\nimport { getSetting } from '@/lib/actions/setting.actions'\nimport Product from '@/lib/db/models/product.model'\nimport { connectToDatabase } from '@/lib/db'\nimport { routing } from '@/i18n/routing'\n\ntype SitemapEntry = {\n  url: string\n  lastModified: Date\n  changeFrequency:\n    | 'always'\n    | 'hourly'\n    | 'daily'\n    | 'weekly'\n    | 'monthly'\n    | 'yearly'\n    | 'never'\n  priority: number\n}\n\nconst STATIC_PAGES = [\n  { path: '', priority: 1.0 },\n  { path: '/search', priority: 0.8 },\n  { path: '/cart', priority: 0.6 },\n  { path: '/categories', priority: 0.8 },\n  { path: '/blog', priority: 0.9 },\n] as const\n\nconst DEFAULT_BASE_URL = 'https://hager-zon.vercel.app'\n\nconst getBaseUrl = (url?: string): string => {\n  // Use only the official domain, ignore previews or wrong domains\n  if (url && url.startsWith('https://hager-zon.vercel.app')) return url.replace(/\\/+$/, '')\n  return DEFAULT_BASE_URL\n}\n\nconst createStaticRoutes = (baseUrl: string): SitemapEntry[] => {\n  const routes: SitemapEntry[] = []\n  for (const locale of routing.locales) {\n    for (const { path, priority } of STATIC_PAGES) {\n      routes.push({\n        url: `${baseUrl}/${locale}${path}`,\n        lastModified: new Date(),\n        changeFrequency: 'daily',\n        priority,\n      })\n    }\n  }\n  return routes\n}\n\nexport default async function sitemap(): Promise<MetadataRoute.Sitemap> {\n  try {\n    await connectToDatabase()\n    const {\n      site: { url },\n    } = await getSetting()\n    const baseUrl = getBaseUrl(url)\n\n    const products = await Product.find({\n      isPublished: true,\n      deletedAt: { $exists: false },\n    })\n      .select('slug updatedAt')\n      .lean()\n\n    const productUrls: SitemapEntry[] = []\n    for (const product of products) {\n      for (const locale of routing.locales) {\n        productUrls.push({\n          url: `${baseUrl}/${locale}/product/${product.slug}`,\n          lastModified: product.updatedAt || new Date(),\n          changeFrequency: 'daily',\n          priority: 0.8,\n        })\n      }\n    }\n\n    const staticRoutes = createStaticRoutes(baseUrl)\n    return [...staticRoutes, ...productUrls]\n  } catch (error) {\n    console.error('Error generating sitemap:', error)\n    const baseUrl = DEFAULT_BASE_URL\n    return createStaticRoutes(baseUrl).map((route) => ({\n      ...route,\n      priority: Math.max(route.priority - 0.2, 0),\n    }))\n  }\n}\n\nexport const revalidate = 3600"],"mappings":"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","ignoreList":[]}